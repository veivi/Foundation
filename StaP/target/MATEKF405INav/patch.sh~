#!/bin/bash

target=$1

if [ -z "$target" ]
then
    echo "Target specifier missing."
    exit 0
fi

TARGET_DIR=$FOUNDATION/StaP/target/${target}INav

if [ ! -x $TARGET_DIR ]
then
    echo "Target $target not found."
    exit 0
fi

if [ ! -x src/main/AlphaPilot/TARGET/$target ]
then
    mkdir -p src/main/AlphaPilot/TARGET/$target
fi

update="$ALPHAPILOT/Core/update_file.bash"


$update "$ALPHAPILOT/Core/include/*.h" src/main/AlphaPilot
$update "$ALPHAPILOT/Core/*.c" src/main/AlphaPilot
$update "$FOUNDATION/include/*.h" src/main/AlphaPilot
$update "$FOUNDATION/*.c" src/main/AlphaPilot
$update "$FOUNDATION/StaP/include/*.h" src/main/AlphaPilot
$update "$FOUNDATION/StaP/*.c" src/main/AlphaPilot
$update "$TARGET_DIR//include/*.h" src/main/AlphaPilot
$update "$TARGET_DIR/*.c" src/main/AlphaPilot
$update $TARGET_DIR/StaP.c src/main/AlphaPilot/TARGET
$update $TARGET_DIR/include/StaP_INAV.h src/main/AlphaPilot/TARGET
$update $TARGET_DIR/include/StaP_TARGET.h src/main/AlphaPilot/TARGET
$update $TARGET_DIR/include/StaP_FEATURE.h src/main/AlphaPilot/TARGET
$update $TARGET_DIR/include/target.h src/main/target/$target
$update $TARGET_DIR/CMakeLists.txt src/main
$update $TARGET_DIR/main.cmake cmake
$update $TARGET_DIR/main.c src/main
$update $TARGET_DIR/fc_tasks.c src/main/fc
$update $TARGET_DIR/serial.c src/main/io
$update $TARGET_DIR/serial_uart_stm32f4xx.c src/main/drivers
$update $TARGET_DIR/msp_serial.c src/main/msp
$update $TARGET_DIR/rx_pwm.c src/main/drivers
$update $TARGET_DIR/config.c src/main/target/$target
$update $TARGET_DIR/target.c src/main/target/$target
$update $TARGET_DIR/include/bus_i2c.h src/main/drivers
$update $TARGET_DIR/bus_i2c_stm32f40x.c src/main/drivers



